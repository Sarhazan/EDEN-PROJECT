---
phase: 02-resizable-columns
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - client/package.json
  - client/src/pages/MyDayPage.jsx
autonomous: true

must_haves:
  truths:
    - "Manager can drag slider between recurring and one-time task columns"
    - "Column widths are constrained between 250px minimum and 70% maximum"
    - "Adjusted widths persist across browser sessions"
    - "Reset button restores default 50-50 split"
    - "Resizable slider only appears on desktop (>= 1024px)"
  artifacts:
    - path: "client/package.json"
      provides: "re-resizable library dependency"
      contains: "re-resizable"
    - path: "client/src/pages/MyDayPage.jsx"
      provides: "Resizable columns with persistence and reset"
      min_lines: 1050
  key_links:
    - from: "client/src/pages/MyDayPage.jsx"
      to: "localStorage"
      via: "myDayColumnWidths key with debounced writes"
      pattern: "localStorage\\.(get|set)Item.*myDayColumnWidths"
    - from: "Resizable component"
      to: "col-span-8 and col-span-4 divs"
      via: "size prop controls width dynamically"
      pattern: "size=\\{.*width:.*\\}"
---

<objective>
Enable managers to customize the width of recurring vs one-time task columns in "My Day" view by dragging a resizable slider, with preferences persisting across browser sessions.

Purpose: Different managers have different workflows - some focus heavily on recurring tasks (want wider left column), others manage many one-time tasks (want wider right column). Customizable layout improves usability for individual preferences.

Output: Working resizable column divider in MyDayPage split layout (desktop only, >= 1024px), with localStorage persistence, width constraints (250px min, 70% max), and reset button to restore defaults.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-resizable-columns/02-CONTEXT.md

# Current implementation
@client/src/pages/MyDayPage.jsx

# Prior phase context (for patterns)
@.planning/phases/01-stars-system/01-03-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install re-resizable library</name>
  <files>client/package.json</files>
  <action>
Install re-resizable library for React resizable components.

```bash
cd client
npm install re-resizable@6.9.17
```

Why re-resizable:
- Recommended in requirements (6.9.17)
- Lightweight (~18KB gzipped)
- Works with React 19 and Tailwind
- Supports controlled resizing with min/max constraints
- Good TypeScript support and maintained

DO NOT use react-resizable-panels or react-split-pane - re-resizable is specified in requirements.
  </action>
  <verify>
```bash
grep "re-resizable" client/package.json
```
Should show: `"re-resizable": "6.9.17"`
  </verify>
  <done>re-resizable@6.9.17 added to dependencies in client/package.json</done>
</task>

<task type="auto">
  <name>Task 2: Implement resizable columns with localStorage persistence</name>
  <files>client/src/pages/MyDayPage.jsx</files>
  <action>
Add resizable column functionality to the split layout in MyDayPage (lines 845-994, the grid grid-cols-12 section).

**Implementation requirements:**

1. **Import Resizable component**
```javascript
import { Resizable } from 're-resizable';
```

2. **Add state for column widths with localStorage initialization**
```javascript
// Initialize from localStorage or use default 50-50 split
const [columnWidths, setColumnWidths] = useState(() => {
  const stored = localStorage.getItem('myDayColumnWidths');
  if (stored) {
    try {
      return JSON.parse(stored);
    } catch (e) {
      console.error('Failed to parse column widths:', e);
    }
  }
  // Default: 66.67% / 33.33% (matches col-span-8 / col-span-4)
  return { left: '66.67%', right: '33.33%' };
});
```

3. **Debounced localStorage save** (prevent excessive writes during drag)
```javascript
// Debounce save to localStorage
useEffect(() => {
  const timeoutId = setTimeout(() => {
    localStorage.setItem('myDayColumnWidths', JSON.stringify(columnWidths));
  }, 100); // 100ms debounce as specified in requirements

  return () => clearTimeout(timeoutId);
}, [columnWidths]);
```

4. **Wrap left column (recurring tasks) in Resizable component**
Replace the `<div className="col-span-8">` with:
```jsx
<Resizable
  size={{ width: columnWidths.left, height: 'auto' }}
  onResizeStop={(e, direction, ref, d) => {
    const container = ref.parentElement;
    const containerWidth = container.offsetWidth;
    const newLeftWidth = ref.offsetWidth;
    const newRightWidth = containerWidth - newLeftWidth - 24; // 24px = gap-6

    // Enforce min-width: 250px for both columns
    if (newLeftWidth < 250 || newRightWidth < 250) return;

    // Enforce max-width: 70% for both columns
    const leftPercent = (newLeftWidth / containerWidth) * 100;
    const rightPercent = (newRightWidth / containerWidth) * 100;
    if (leftPercent > 70 || rightPercent > 70) return;

    setColumnWidths({
      left: `${newLeftWidth}px`,
      right: `${newRightWidth}px`
    });
  }}
  enable={{
    top: false,
    right: true, // Only allow horizontal resize on right edge
    bottom: false,
    left: false,
    topRight: false,
    bottomRight: false,
    bottomLeft: false,
    topLeft: false
  }}
  minWidth={250}
  maxWidth="70%"
  className="relative"
  handleStyles={{
    right: {
      width: '8px',
      right: '-4px',
      cursor: 'col-resize',
      backgroundColor: 'transparent',
      zIndex: 10
    }
  }}
  handleClasses={{
    right: 'hover:bg-indigo-200 transition-colors'
  }}
>
  <div className="bg-white rounded-lg shadow-md p-4">
    {/* Existing recurring tasks content */}
  </div>
</Resizable>
```

5. **Update right column to use controlled width**
Replace `<div className="col-span-4">` with:
```jsx
<div style={{ width: columnWidths.right }} className="relative">
  {/* Existing one-time tasks content */}
</div>
```

6. **Update parent grid container** (line 845)
Change from `grid grid-cols-12 gap-6` to `flex gap-6` to support pixel-based widths instead of grid columns.

7. **Hide resizable columns on mobile** (< 1024px)
Wrap the flex layout in a responsive check. On mobile, keep the original grid layout without resizing:
```jsx
{/* Desktop: Resizable columns (>= 1024px) */}
<div className="hidden lg:flex gap-6">
  {/* Resizable implementation */}
</div>

{/* Mobile: Stack vertically (< 1024px) */}
<div className="lg:hidden grid grid-cols-1 gap-6">
  {/* Same content, but stacked */}
</div>
```

**Visual feedback during resize:**
- cursor: col-resize shows on hover over resize handle
- Handle has subtle hover state (bg-indigo-200)
- Width constraints enforced in onResizeStop callback

**DO NOT:**
- Change the content of recurring/one-time task columns
- Add resize handles to the employee-filtered unified view (line 722-842)
- Break existing filters, sorting, or star filter functionality
- Remove any existing features
  </action>
  <verify>
1. Start dev server and navigate to "היום שלי"
2. Verify desktop view (>= 1024px) shows resizable columns
3. Drag the divider between columns - should resize smoothly
4. Verify constraints: cannot make column < 250px or > 70%
5. Refresh page - column widths should persist
6. Check localStorage in DevTools: `myDayColumnWidths` key exists with JSON value
7. Resize to mobile (< 1024px) - resizable divider should disappear, columns stack vertically
8. Verify all existing features still work (filters, star filter, bulk send)
  </verify>
  <done>Resizable columns working in desktop view with localStorage persistence, width constraints enforced, mobile view unchanged (stacked layout)</done>
</task>

<task type="auto">
  <name>Task 3: Add reset button to restore default column widths</name>
  <files>client/src/pages/MyDayPage.jsx</files>
  <action>
Add a reset button above the resizable columns to restore the default 50-50 split.

**Implementation:**

1. **Add reset function**
```javascript
const handleResetColumnWidths = () => {
  const defaultWidths = { left: '66.67%', right: '33.33%' };
  setColumnWidths(defaultWidths);
  localStorage.setItem('myDayColumnWidths', JSON.stringify(defaultWidths));
};
```

2. **Add reset button in UI**
Insert button ABOVE the resizable columns section (before line 845), aligned to the left:
```jsx
{/* Column width reset button - Desktop only */}
<div className="hidden lg:flex justify-start mb-3">
  <button
    onClick={handleResetColumnWidths}
    className="text-sm text-gray-600 hover:text-indigo-600 underline"
  >
    איפוס גודל עמודות
  </button>
</div>
```

**Button placement:** Between the progress bar section (lines 703-719) and the split layout section (line 845).

**Styling rationale:**
- Small, unobtrusive (text-sm)
- Underlined link style (not prominent button)
- Hover state for discoverability
- Hebrew text: "איפוס גודל עמודות" (Reset column sizes)
- Hidden on mobile (hidden lg:flex) since resizing isn't available there

**DO NOT:**
- Add confirmation dialog (not needed for non-destructive action)
- Make button too prominent (this is a utility feature, not primary action)
  </action>
  <verify>
1. Navigate to "היום שלי" on desktop
2. Resize columns away from default
3. Click "איפוס גודל עמודות" button
4. Verify columns return to default 66.67% / 33.33% split
5. Verify localStorage is updated with default values
6. Check mobile view - button should not appear (< 1024px)
  </verify>
  <done>Reset button working, restores default column widths and updates localStorage</done>
</task>

</tasks>

<verification>
## Overall Phase Checks

After all tasks complete:

1. **Desktop functionality (>= 1024px):**
   - [ ] Resizable divider visible between columns
   - [ ] Drag handle has cursor: col-resize on hover
   - [ ] Columns resize smoothly during drag
   - [ ] Cannot resize below 250px minimum
   - [ ] Cannot resize beyond 70% maximum
   - [ ] Column widths persist after browser refresh
   - [ ] Reset button restores default 66.67% / 33.33% split

2. **Mobile behavior (< 1024px):**
   - [ ] Resizable divider hidden
   - [ ] Columns stack vertically (grid-cols-1)
   - [ ] Reset button hidden
   - [ ] No layout issues or overlaps

3. **Integration:**
   - [ ] Existing filters work (priority, system, status, employee, location)
   - [ ] Star filter works correctly
   - [ ] Bulk send button works
   - [ ] Task cards render correctly in both columns
   - [ ] No console errors

4. **Persistence:**
   - [ ] localStorage key `myDayColumnWidths` exists
   - [ ] Value is valid JSON with left/right properties
   - [ ] Debounce prevents excessive writes during drag
   - [ ] Cross-tab sync not required (localStorage getter on mount is sufficient)

## Requirements Coverage

| Requirement | Verification |
|-------------|--------------|
| RESIZE-01: slider between columns | Resizable handle visible on desktop |
| RESIZE-02: drag changes width | onResizeStop updates state |
| RESIZE-03: min-width 250px | Enforced in onResizeStop callback |
| RESIZE-04: max-width 70% | Enforced in onResizeStop callback |
| RESIZE-05: cursor col-resize | handleStyles sets cursor |
| RESIZE-06: visual divider | Resizable handle with hover state |
| RESIZE-07: localStorage persistence | myDayColumnWidths key |
| RESIZE-08: restore on load | useState initializer reads localStorage |
| RESIZE-09: debounce 100ms | useEffect with 100ms timeout |
| RESIZE-10: reset button | handleResetColumnWidths function |
| RESIZE-11: desktop only (>= 1024px) | hidden lg:flex / lg:hidden classes |

All 11 requirements covered.
</verification>

<success_criteria>
## Measurable Completion

Phase 02 is complete when:

1. Manager visits "היום שלי" on desktop (>= 1024px) and sees resizable divider between columns
2. Manager drags divider left/right and columns resize dynamically
3. Manager cannot resize columns beyond constraints (250px min, 70% max)
4. Manager refreshes browser and column widths are restored from previous session
5. Manager clicks "איפוס גודל עמודות" and columns return to 66.67% / 33.33% split
6. Manager resizes browser to mobile (< 1024px) and resizable divider disappears, columns stack vertically
7. All existing features continue working (filters, star filter, task cards, bulk send)

**User value delivered:** Managers can now customize their "My Day" view to match their workflow - wider left column for recurring task focus, or wider right column for one-time task management. Preferences persist across sessions for consistent daily experience.
</success_criteria>

<output>
After completion, create `.planning/phases/02-resizable-columns/02-01-SUMMARY.md` following the template structure with frontmatter dependency graph, tech tracking, key decisions, and accomplishments.
</output>

---
phase: 03-mobile-responsive-experience
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - client/src/components/layout/MobileDrawer.jsx
  - client/src/components/layout/HamburgerButton.jsx
  - client/src/App.jsx
  - client/src/hooks/useMediaQuery.js
  - client/package.json
autonomous: true

must_haves:
  truths:
    - "Manager can open hamburger menu on mobile and access all navigation items"
    - "Menu drawer slides from right-to-left (RTL) for Hebrew interface"
    - "Manager can swipe right-to-left to close drawer on mobile"
    - "Drawer closes when tapping backdrop or navigation item"
    - "Desktop sidebar and mobile drawer toggle at 1024px breakpoint"
  artifacts:
    - path: "client/src/components/layout/MobileDrawer.jsx"
      provides: "RTL drawer with swipe-to-close and backdrop"
      min_lines: 80
    - path: "client/src/components/layout/HamburgerButton.jsx"
      provides: "Hamburger menu button with 44x44px touch target"
      min_lines: 20
    - path: "client/src/hooks/useMediaQuery.js"
      provides: "Responsive breakpoint detection hook"
      exports: ["useMediaQuery"]
    - path: "client/package.json"
      contains: "react-swipeable"
  key_links:
    - from: "client/src/components/layout/HamburgerButton.jsx"
      to: "App.jsx drawer state"
      via: "onClick toggles drawerOpen"
      pattern: "onClick.*setDrawerOpen"
    - from: "client/src/components/layout/MobileDrawer.jsx"
      to: "react-swipeable"
      via: "swipe gesture detection"
      pattern: "useSwipeable.*onSwipedRight"
    - from: "client/src/App.jsx"
      to: "useMediaQuery hook"
      via: "breakpoint detection for drawer/sidebar toggle"
      pattern: "useMediaQuery.*1024px"
---

<objective>
Enable mobile navigation with RTL hamburger drawer, replacing desktop sidebar on screens < 1024px. Managers can access all navigation items via hamburger menu with swipe-to-close gesture and backdrop tap.

Purpose: Core mobile navigation requirement - without this, mobile users cannot navigate the app
Output: Working hamburger drawer with RTL slide-in animation, swipe gestures, and responsive breakpoint toggling
</objective>

<execution_context>
@c:\dev\projects\claude projects\eden claude\.claude\get-shit-done\workflows\execute-plan.md
@c:\dev\projects\claude projects\eden claude\.claude\get-shit-done\templates\summary.md
</execution_context>

<context>
@c:\dev\projects\claude projects\eden claude\.planning\PROJECT.md
@c:\dev\projects\claude projects\eden claude\.planning\ROADMAP.md
@c:\dev\projects\claude projects\eden claude\.planning\STATE.md
@c:\dev\projects\claude projects\eden claude\.planning\phases\03-mobile-responsive-experience\03-CONTEXT.md
@c:\dev\projects\claude projects\eden claude\.planning\phases\03-mobile-responsive-experience\03-RESEARCH.md
@c:\dev\projects\claude projects\eden claude\.planning\codebase\STRUCTURE.md
@c:\dev\projects\claude projects\eden claude\.planning\codebase\CONVENTIONS.md
@c:\dev\projects\claude projects\eden claude\client\src\components\layout\Sidebar.jsx
@c:\dev\projects\claude projects\eden claude\client\src\App.jsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install react-swipeable and create useMediaQuery hook</name>
  <files>
    client/package.json
    client/src/hooks/useMediaQuery.js
  </files>
  <action>
Install react-swipeable library for swipe gesture detection:
- Run `npm install react-swipeable --prefix client` (do NOT use --legacy-peer-deps - react-swipeable supports React 19)
- Verify installation in client/package.json (version 7.0.2+)

Create client/src/hooks/useMediaQuery.js:
- Export useMediaQuery hook that accepts CSS media query string
- Use window.matchMedia() with useState and useEffect
- Add cleanup for event listener (addEventListener + removeEventListener)
- Return boolean indicating current match state
- Follow research example 3 pattern exactly (includes match state initialization)
- Use 2-space indentation, no semicolons (Eden client convention)

Why react-swipeable: Handles edge cases (multi-touch, velocity, direction thresholds, iOS quirks, passive events) that custom touch handlers miss. Research identified 10+ edge cases avoided by using this library.
  </action>
  <verify>
- Run `grep "react-swipeable" "client/package.json"` to confirm installation
- Run `node -e "console.log(require('./client/package.json').dependencies['react-swipeable'])"` to verify version
- File exists: client/src/hooks/useMediaQuery.js
- Hook exports useMediaQuery function with proper cleanup
  </verify>
  <done>
- react-swipeable appears in client/package.json dependencies
- useMediaQuery.js exists and exports working hook
- Hook properly cleans up event listeners on unmount
  </done>
</task>

<task type="auto">
  <name>Task 2: Create MobileDrawer component with RTL slide-in and swipe-to-close</name>
  <files>
    client/src/components/layout/MobileDrawer.jsx
  </files>
  <action>
Create client/src/components/layout/MobileDrawer.jsx with RTL drawer implementation:

Component structure:
- Accept props: { isOpen, onClose, navItems }
- Import useSwipeable from react-swipeable
- Import FaTimes from react-icons/fa
- Import useEffect from react

Swipe gesture setup:
- Configure useSwipeable with onSwipedRight callback to onClose (RTL: right-to-left swipe closes)
- Set trackMouse: false (disable mouse swiping on desktop)
- Set preventScrollOnSwipe: true

iOS Safari scroll lock (CRITICAL - research pitfall 2):
- useEffect hook triggered by isOpen
- When open: save scrollY position, set body style.position = 'fixed', style.top = `-${scrollY}px`, style.width = '100%'
- On cleanup: restore body styles, call window.scrollTo(0, scrollY)
- This pattern is required because iOS Safari ignores overflow: hidden on body

Backdrop:
- Fixed inset-0, bg-black/60, backdrop-blur-sm, z-40
- Transition opacity 300ms (duration-300)
- When isOpen: opacity-100, else: opacity-0 pointer-events-none
- onClick triggers onClose
- Include aria-hidden="true"

Drawer:
- Fixed top-0 right-0 (RTL positioning), h-full, w-72
- Apply swipeHandlers spread {...swipeHandlers}
- bg-gradient-to-b from-gray-900 to-gray-800 (matches Sidebar.jsx gradient)
- shadow-xl, z-50
- Transition transform 300ms (duration-300 per MOB-NAV-06)
- When isOpen: translate-x-0, else: translate-x-full (hidden off right edge)
- aria-label="תפריט ניווט ראשי"

Drawer header:
- p-8, border-b border-gray-700/50, flex items-center justify-between
- h1: "ניהול תחזוקה" with text-2xl font-bold font-alef text-white
- Close button (FaTimes): p-2 rounded-lg text-white, hover:bg-gray-700, active:scale-95, transition-all duration-150
- Close button aria-label="סגור תפריט"

Navigation items:
- Container: p-4 space-y-2
- Map over navItems array
- Each item: NavLink with to={item.path}, onClick={onClose} (close on navigate)
- NavLink className function with isActive parameter
- Active: bg-primary text-white shadow-lg
- Inactive: text-gray-300 hover:bg-gray-800 active:scale-95
- All items: flex items-center gap-4 px-4 py-3 rounded-xl transition-all duration-200
- Render item.icon (text-xl) and item.label (text-base font-medium)

Use research Example 1 as reference but adapt to Eden's existing patterns (gradient, fonts, Hebrew text).
NO semicolons (Eden client convention).
  </action>
  <verify>
- File exists: client/src/components/layout/MobileDrawer.jsx
- Component exports default function MobileDrawer
- Swipe handler configured with onSwipedRight
- iOS scroll lock implemented with position: fixed pattern
- Drawer slides from right with translate-x-full when closed
- Uses Eden's gray-900/gray-800 gradient (matches Sidebar)
- All Hebrew text uses font-alef
  </verify>
  <done>
- MobileDrawer.jsx component created with RTL slide-in animation
- Swipe right-to-left gesture closes drawer
- Backdrop tap closes drawer
- iOS Safari scroll lock prevents background scrolling
- Navigation items close drawer when clicked
- Component follows Eden conventions (no semicolons, 2-space indent, Hebrew text)
  </done>
</task>

<task type="auto">
  <name>Task 3: Create HamburgerButton and integrate drawer into App.jsx</name>
  <files>
    client/src/components/layout/HamburgerButton.jsx
    client/src/App.jsx
  </files>
  <action>
Create client/src/components/layout/HamburgerButton.jsx:
- Accept props: { onClick, className = '' }
- Import FaBars from react-icons/fa
- Button with onClick handler
- Classes: p-3 rounded-lg text-gray-900, bg-white shadow-md, hover:bg-gray-50, active:scale-95 active:shadow-sm, transition-all duration-150
- min-h-[44px] min-w-[44px] (MOB-TOUCH-01 - Apple HIG standard for touch targets)
- flex items-center justify-center
- Append className prop to allow positioning
- aria-label="פתח תפריט ניווט"
- Render FaBars icon with text-xl
- Default export component

Modify client/src/App.jsx:
1. Import new components:
   - import MobileDrawer from './components/layout/MobileDrawer'
   - import HamburgerButton from './components/layout/HamburgerButton'
   - import { useMediaQuery } from './hooks/useMediaQuery'

2. Add state in MainContent function (after existing useState calls):
   - const [drawerOpen, setDrawerOpen] = useState(false)
   - const isMobile = useMediaQuery('(max-width: 1023px)') // Mobile = <1024px
   - const isDesktop = useMediaQuery('(min-width: 1024px)') // Desktop = >=1024px

3. Build navItems array from existing Sidebar navigation (before return):
   - Extract navigation items from Sidebar.jsx: "היום שלי", "כל המשימות", "היסטוריה", "מערכות", "ספקים", "עובדים", "מיקומים", "הגדרות"
   - Create navItems array with { path, label, icon } objects
   - Import icons: FaHome, FaTasks, FaHistory, FaCog, FaTools, FaTruck, FaUsers, FaMapMarkerAlt (check Sidebar.jsx for exact icons)
   - Verification: Use `grep "NavLink" client/src/components/layout/Sidebar.jsx` to extract exact paths and labels

4. Conditional rendering (modify existing layout):
   - Desktop (isDesktop): show <Sidebar className="hidden lg:block" />
   - Mobile (isMobile): show <HamburgerButton onClick={() => setDrawerOpen(true)} className="fixed top-4 right-4 z-30 lg:hidden" />
   - Always render: <MobileDrawer isOpen={drawerOpen && isMobile} onClose={() => setDrawerOpen(false)} navItems={navItems} />

5. Auto-close drawer on route change:
   - Add useEffect: useEffect(() => { setDrawerOpen(false) }, [location.pathname])

Why position fixed top-4 right-4: Hamburger must be visible at top-right corner (MOB-NAV-01 requirement) across all pages. z-30 ensures it's above page content but below drawer (z-50).

NO semicolons in client code.
  </action>
  <verify>
- File exists: client/src/components/layout/HamburgerButton.jsx
- HamburgerButton has 44x44px minimum touch target
- App.jsx imports MobileDrawer, HamburgerButton, useMediaQuery
- App.jsx has drawerOpen state and isMobile/isDesktop breakpoint detection
- navItems array constructed with all navigation paths
- Verification: Run `grep "NavLink" client/src/components/layout/Sidebar.jsx` to confirm nav items match
- Conditional rendering: Sidebar shows on desktop (lg:block), hamburger shows on mobile (lg:hidden)
- Route change effect closes drawer
  </verify>
  <done>
- HamburgerButton component created with 44x44px touch target
- App.jsx integrates drawer with responsive breakpoint toggling
- Desktop users see Sidebar (>=1024px)
- Mobile users see hamburger button (<1024px)
- Drawer opens/closes correctly based on user interaction
- Navigation works identically to desktop Sidebar
  </done>
</task>

</tasks>

<verification>
Overall phase checks after all tasks complete:

**Functional verification:**
1. Resize browser to <1024px width - hamburger button appears top-right, Sidebar disappears
2. Click hamburger - drawer slides in from right with 300ms animation
3. Click backdrop - drawer closes with slide-out animation
4. Open drawer, swipe from center toward right edge - drawer closes
5. Resize to >=1024px - hamburger disappears, Sidebar appears
6. Click any navigation item in drawer - navigates AND closes drawer
7. Open drawer on mobile, try scrolling background - background should NOT scroll (iOS fix)

**Visual verification:**
- Drawer matches Sidebar gradient (gray-900 to gray-800)
- Hebrew text uses font-alef
- Navigation icons match desktop Sidebar
- Close button (X) visible top-left of drawer header
- Backdrop has blur effect (backdrop-blur-sm)
- Hamburger button has white background with shadow

**Touch verification:**
- Hamburger button minimum 44x44px (measure with browser dev tools)
- Close button in drawer minimum 44x44px
- All navigation items have adequate tap targets

**Breakpoint verification:**
- Test at 1023px (mobile) - drawer UI
- Test at 1024px (desktop) - sidebar UI
- No overlap or double-rendering at breakpoint
</verification>

<success_criteria>
**Must be TRUE:**
1. Manager can open hamburger menu on mobile (<1024px) and access all 8 navigation items (MOB-NAV-01, MOB-NAV-04)
2. Menu drawer slides from right-to-left with 300ms animation (MOB-NAV-03, MOB-NAV-06)
3. Drawer closes when tapping backdrop, clicking navigation item, or swiping right-to-left (MOB-NAV-05, MOB-NAV-07)
4. Desktop sidebar hides on mobile, hamburger hides on desktop - clean toggle at 1024px breakpoint (MOB-NAV-02)
5. Background scrolling is locked when drawer is open on iOS Safari (research pitfall 2 addressed)

**Measurable outcomes:**
- react-swipeable in client/package.json dependencies
- 3 new files created: MobileDrawer.jsx, HamburgerButton.jsx, useMediaQuery.js
- App.jsx modified with drawer state and conditional rendering
- Swipe gesture closes drawer (test with touch device or browser mobile emulation)
- All 21 MOB requirements addressed (7 MOB-NAV requirements completed in this plan)
</success_criteria>

<output>
After completion, create `.planning/phases/03-mobile-responsive-experience/03-01-SUMMARY.md`

Include:
- Which navigation items are accessible via drawer
- Breakpoint thresholds (1024px)
- Drawer animation timing (300ms)
- Swipe gesture direction (right-to-left closes in RTL)
- iOS Safari scroll lock implementation details
</output>
